<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Date Widget</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Megrim&family=Major+Mono+Display&display=swap" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        html, body {
            width: 400px;
            height: 200px;
            background: transparent !important;
            overflow: hidden;
            font-family: 'Arial', sans-serif;
            user-select: none;
            -webkit-user-select: none;
        }
        
        .widget-container {
            width: 100%;
            height: 100%;
            background: transparent;
            border-radius: 20px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            position: relative;
            overflow: hidden;
            transform-origin: center;
        }
        
        .widget-container.locked {
            -webkit-app-region: no-drag;
            cursor: default;
        }
        
        .widget-container:not(.locked) {
            -webkit-app-region: drag;
            cursor: move;
        }
        
        .day-name {
            font-size: 3.5rem;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 8px;
            text-shadow: 3px 3px 6px rgba(0, 0, 0, 0.3);
            margin-bottom: 10px;
            background: linear-gradient(45deg, #FFD700, #FFA500);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            position: relative;
            z-index: 1;
            font-family: 'Megrim', cursive;
        }
        
        .date-info {
            text-align: center;
            position: relative;
            z-index: 1;
        }
        
        .date {
            font-size: 1.4rem;
            font-weight: 600;
            margin-bottom: 5px;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            font-family: 'Megrim', cursive;
        }
        
        .time {
            font-size: 1.2rem;
            font-weight: 500;
            color: #FFD700;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
            font-family: 'Megrim', cursive;
        }
        
        .time.hidden {
            display: none;
        }
        
        /* Font families */
        .font-megrim {
            font-family: 'Megrim', cursive;
        }
        
        .font-major-mono {
            font-family: 'Major Mono Display', monospace;
        }
        
        .font-lment {
            font-family: 'Lment-v02', sans-serif;
        }
        
        .font-kapiler {
            font-family: 'Kapiler-Regular', sans-serif;
        }
        
        .font-arial {
            font-family: 'Arial', sans-serif;
        }
        
        .font-times {
            font-family: 'Times New Roman', serif;
        }
        
        /* Alignment classes */
        .align-left {
            text-align: left;
        }
        
        .align-center {
            text-align: center;
        }
        
        .align-right {
            text-align: right;
        }
        
        /* Bold text */
        .bold-text .day-name,
        .bold-text .date,
        .bold-text .time {
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="widget-container" id="widgetContainer">
        <div class="day-name" id="dayName">WEDNESDAY</div>
        <div class="date-info" id="dateInfo">
            <div class="date" id="dateText">13 MAR 2024</div>
            <div class="time" id="timeText">16:20</div>
        </div>
    </div>
    
    <script>
        let settings = {
            enabled: true,
            locked: false,
            showTime: true,
            boldText: false,
            scale: 1,
            color: '#FFD700',
            font: 'Megrim',
            alignment: 'center'
        };

        // Parse settings from URL
        function parseSettings() {
            const urlParams = new URLSearchParams(window.location.search);
            const settingsParam = urlParams.get('settings');
            
            if (settingsParam) {
                try {
                    const decodedSettings = decodeURIComponent(settingsParam);
                    settings = JSON.parse(decodedSettings);
                    console.log('Parsed settings:', settings);
                } catch (error) {
                    console.error('Error parsing settings:', error);
                }
            }
        }

        // Apply settings to the widget
        function applySettings() {
            const container = document.getElementById('widgetContainer');
            const dayName = document.getElementById('dayName');
            const dateInfo = document.getElementById('dateInfo');
            const dateText = document.getElementById('dateText');
            const timeText = document.getElementById('timeText');

            // Apply scale
            container.style.transform = `scale(${settings.scale})`;

            // Apply color
            dayName.style.color = settings.color;
            dateText.style.color = settings.color;
            timeText.style.color = settings.color;

            // Apply font
            const fontClass = `font-${settings.font.toLowerCase().replace(/\s+/g, '-').replace('major-mono-display', 'major-mono')}`;
            dayName.className = `day-name ${fontClass}`;
            dateText.className = `date ${fontClass}`;
            timeText.className = `time ${fontClass}`;

            // Apply alignment
            const alignClass = `align-${settings.alignment}`;
            dateInfo.className = `date-info ${alignClass}`;

            // Apply bold text
            if (settings.boldText) {
                container.classList.add('bold-text');
            } else {
                container.classList.remove('bold-text');
            }

            // Apply lock state
            if (settings.locked) {
                container.classList.add('locked');
            } else {
                container.classList.remove('locked');
            }

            // Show/hide time
            if (settings.showTime) {
                timeText.classList.remove('hidden');
            } else {
                timeText.classList.add('hidden');
            }
        }

        // Update date and time
        function updateDateTime() {
            const now = new Date();
            
            // Day name
            const dayNames = ['SUNDAY', 'MONDAY', 'TUESDAY', 'WEDNESDAY', 'THURSDAY', 'FRIDAY', 'SATURDAY'];
            document.getElementById('dayName').textContent = dayNames[now.getDay()];
            
            // Date in format: DD MMM YYYY
            const monthNames = ['JAN', 'FEB', 'MAR', 'APR', 'MAY', 'JUN',
                'JUL', 'AUG', 'SEP', 'OCT', 'NOV', 'DEC'];
            const dateText = `${now.getDate().toString().padStart(2, '0')} ${monthNames[now.getMonth()]} ${now.getFullYear()}`;
            document.getElementById('dateText').textContent = dateText;
            
            // Time in 24-hour format
            const hours = now.getHours().toString().padStart(2, '0');
            const minutes = now.getMinutes().toString().padStart(2, '0');
            const timeText = `${hours}:${minutes}`;
            document.getElementById('timeText').textContent = timeText;
        }

        // Initialize
        parseSettings();
        applySettings();
        updateDateTime();
        setInterval(updateDateTime, 1000); // Update every second

        console.log('Date widget loaded successfully with settings:', settings);
    </script>
</body>
</html>